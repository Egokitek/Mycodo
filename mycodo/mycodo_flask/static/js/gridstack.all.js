!function(t){if("function"==typeof define&&define.amd)define(["jquery","exports"],t);else if("undefined"!=typeof exports){var e;try{e=require("jquery")}catch(t){}t(e||window.jQuery,exports)}else t(window.jQuery,window)}(function(t,e){function i(t,e,i){function o(){return console.warn("gridstack.js: Function `"+e+"` is deprecated as of v0.2.5 and has been replaced with `"+i+"`. It will be **completely** removed in v1.0."),t.apply(this,arguments)}return o.prototype=t.prototype,o}function o(t,e,i){void 0!==t[e]&&(t[i]=t[e],console.warn("gridstack.js: Option `"+e+"` is deprecated as of v0.2.5 and has been replaced with `"+i+"`. It will be **completely** removed in v1.0."))}function a(t,e,i){var o=t.attr(e);void 0!==o&&(t.attr(i,o),console.warn("gridstack.js: attribute `"+e+"`="+o+" is deprecated on this object as of v0.5.2 and has been replaced with `"+i+"`. It will be **completely** removed in v1.0."))}var r={isIntercepted:function(t,e){return!(t.x+t.width<=e.x||e.x+e.width<=t.x||t.y+t.height<=e.y||e.y+e.height<=t.y)},sort:function(t,e,i){if(!i){var o=t.map(function(t){return t.x+t.width});i=Math.max.apply(Math,o)}return e=-1!==e?1:-1,r.sortBy(t,function(t){return e*(t.x+t.y*i)})},createStylesheet:function(t){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.setAttribute("data-gs-style-id",t),e.styleSheet?e.styleSheet.cssText="":e.appendChild(document.createTextNode("")),document.getElementsByTagName("head")[0].appendChild(e),e.sheet},removeStylesheet:function(e){t("STYLE[data-gs-style-id="+e+"]").remove()},insertCSSRule:function(t,e,i,o){"function"==typeof t.insertRule?t.insertRule(e+"{"+i+"}",o):"function"==typeof t.addRule&&t.addRule(e,i,o)},toBool:function(t){return"boolean"==typeof t?t:"string"==typeof t?!(""===(t=t.toLowerCase())||"no"===t||"false"===t||"0"===t):Boolean(t)},_collisionNodeCheck:function(t){return t!==this.node&&r.isIntercepted(t,this.nn)},_didCollide:function(t){return r.isIntercepted({x:this.n.x,y:this.newY,width:this.n.width,height:this.n.height},t)},_isAddNodeIntercepted:function(t){return r.isIntercepted({x:this.x,y:this.y,width:this.node.width,height:this.node.height},t)},parseHeight:function(t){var e=t,i="px";if(e&&"string"==typeof e){var o=e.match(/^(-[0-9]+\.[0-9]+|[0-9]*\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw)?$/);if(!o)throw new Error("Invalid height");i=o[2]||"px",e=parseFloat(o[1])}return{height:e,unit:i}},without:function(t,e){var i=t.indexOf(e);return-1!==i&&(t=t.slice(0)).splice(i,1),t},sortBy:function(t,e){return t.slice(0).sort(function(t,i){var o=e(t),a=e(i);return a===o?0:a<o?1:-1})},defaults:function(t){return Array.prototype.slice.call(arguments,1).forEach(function(e){for(var i in e)!e.hasOwnProperty(i)||t.hasOwnProperty(i)&&void 0!==t[i]||(t[i]=e[i])}),t},clone:function(e){return t.extend({},e)},throttle:function(t,e){var i=!1;return function(){i||(t.apply(this,arguments),i=!0,setTimeout(function(){i=!1},e))}},removePositioningStyles:function(t){var e=t[0].style;e.position&&e.removeProperty("position"),e.left&&e.removeProperty("left"),e.top&&e.removeProperty("top"),e.width&&e.removeProperty("width"),e.height&&e.removeProperty("height")},getScrollParent:function(t){return null===t?null:t.scrollHeight>t.clientHeight?t:r.getScrollParent(t.parentNode)},updateScrollPosition:function(t,e,i){var o=t.getBoundingClientRect(),a=window.innerHeight||document.documentElement.clientHeight;if(o.top<0||o.bottom>a){var s=o.bottom-a,n=o.top,d=r.getScrollParent(t);if(null!==d){var h=d.scrollTop;o.top<0&&i<0?t.offsetHeight>a?d.scrollTop+=i:d.scrollTop+=Math.abs(n)>Math.abs(i)?i:n:0<i&&(t.offsetHeight>a?d.scrollTop+=i:d.scrollTop+=i<s?i:s),e.position.top+=d.scrollTop-h}}}};function s(t){this.grid=t}function n(t,e,i,o,a){this.column=t,this.float=i||!1,this.maxRow=o||0,this.nodes=a||[],this.onchange=e||function(){},this._updateCounter=0,this._float=this.float,this._addedNodes=[],this._removedNodes=[]}r.is_intercepted=i(r.isIntercepted,"is_intercepted","isIntercepted"),r.create_stylesheet=i(r.createStylesheet,"create_stylesheet","createStylesheet"),r.remove_stylesheet=i(r.removeStylesheet,"remove_stylesheet","removeStylesheet"),r.insert_css_rule=i(r.insertCSSRule,"insert_css_rule","insertCSSRule"),s.registeredPlugins=[],s.registerPlugin=function(t){s.registeredPlugins.push(t)},s.prototype.resizable=function(t,e){return this},s.prototype.draggable=function(t,e){return this},s.prototype.droppable=function(t,e){return this},s.prototype.isDroppable=function(t){return!1},s.prototype.on=function(t,e,i){return this};var d=0;function h(e,i){var d,h,l=this;i=i||{},this.container=t(e),o(i,"handle_class","handleClass"),o(i,"item_class","itemClass"),o(i,"placeholder_class","placeholderClass"),o(i,"placeholder_text","placeholderText"),o(i,"cell_height","cellHeight"),o(i,"vertical_margin","verticalMargin"),o(i,"min_width","minWidth"),o(i,"static_grid","staticGrid"),o(i,"is_nested","isNested"),o(i,"always_show_resize_handle","alwaysShowResizeHandle"),o(i,"width","column"),o(i,"height","maxRow"),a(this.container,"data-gs-width","data-gs-column"),a(this.container,"data-gs-height","data-gs-max-row"),i.itemClass=i.itemClass||"grid-stack-item";var p=0<this.container.closest("."+i.itemClass).length;if(this.opts=r.defaults(i,{column:parseInt(this.container.attr("data-gs-column"))||12,maxRow:parseInt(this.container.attr("data-gs-max-row"))||0,itemClass:"grid-stack-item",placeholderClass:"grid-stack-placeholder",placeholderText:"",handle:".grid-stack-item-content",handleClass:null,cellHeight:60,verticalMargin:20,auto:!0,minWidth:768,float:!1,staticGrid:!1,_class:"grid-stack-instance-"+(1e4*Math.random()).toFixed(0),animate:Boolean(this.container.attr("data-gs-animate"))||!1,alwaysShowResizeHandle:i.alwaysShowResizeHandle||!1,resizable:r.defaults(i.resizable||{},{autoHide:!i.alwaysShowResizeHandle,handles:"se"}),draggable:r.defaults(i.draggable||{},{handle:(i.handleClass?"."+i.handleClass:i.handle?i.handle:"")||".grid-stack-item-content",scroll:!1,appendTo:"body"}),disableDrag:i.disableDrag||!1,disableResize:i.disableResize||!1,rtl:"auto",removable:!1,removableOptions:r.defaults(i.removableOptions||{},{accept:"."+i.itemClass}),removeTimeout:2e3,verticalMarginUnit:"px",cellHeightUnit:"px",disableOneColumnMode:i.disableOneColumnMode||!1,oneColumnModeClass:i.oneColumnModeClass||"grid-stack-one-column-mode",ddPlugin:null}),!1===this.opts.ddPlugin?this.opts.ddPlugin=s:null===this.opts.ddPlugin&&(this.opts.ddPlugin=s.registeredPlugins[0]||s),this.dd=new this.opts.ddPlugin(this),"auto"===this.opts.rtl&&(this.opts.rtl="rtl"===this.container.css("direction")),this.opts.rtl&&this.container.addClass("grid-stack-rtl"),this.opts.isNested=p,(h="auto"===this.opts.cellHeight)?l.cellHeight(l.cellWidth(),!0):this.cellHeight(this.opts.cellHeight,!0),this.verticalMargin(this.opts.verticalMargin,!0),this.container.addClass(this.opts._class),this._setStaticClass(),p&&this.container.addClass("grid-stack-nested"),this._initStyles(),this.grid=new n(this.opts.column,function(t,e){e=void 0===e||e;var i=0;this.nodes.forEach(function(t){i=Math.max(i,t.y+t.height)}),t.forEach(function(t){e&&null===t._id?t.el&&t.el.remove():t.el.attr("data-gs-x",t.x).attr("data-gs-y",t.y).attr("data-gs-width",t.width).attr("data-gs-height",t.height)}),l._updateStyles(i+10)},this.opts.float,this.opts.maxRow),this.opts.auto){var g=[],c=this;this.container.children("."+this.opts.itemClass+":not(."+this.opts.placeholderClass+")").each(function(e,i){el=$(i);var o=parseInt(el.attr("data-gs-x")),a=parseInt(el.attr("data-gs-y"));i=t(i),g.push({el:i,i:(Number.isNaN(o)?1e3:o)+(Number.isNaN(a)?1e3:a)*c.opts.column})}),r.sortBy(g,function(t){return t.i}).forEach(function(t){this._prepareElement(t.el)},this)}if(this.setAnimation(this.opts.animate),this.placeholder=t('<div class="'+this.opts.placeholderClass+" "+this.opts.itemClass+'"><div class="placeholder-content">'+this.opts.placeholderText+"</div></div>").hide(),this._updateContainerHeight(),this._updateHeightsOnResize=r.throttle(function(){l.cellHeight(l.cellWidth(),!1)},100),this.onResizeHandler=function(){if(h&&l._updateHeightsOnResize(),l._isOneColumnMode()&&!l.opts.disableOneColumnMode){if(d)return;l.container.addClass(l.opts.oneColumnModeClass),d=!0,l.grid._sortNodes(),l.grid.nodes.forEach(function(t){l.container.append(t.el),l.opts.staticGrid||(l.dd.draggable(t.el,"disable"),l.dd.resizable(t.el,"disable"),t.el.trigger("resize"))})}else{if(!d)return;if(l.container.removeClass(l.opts.oneColumnModeClass),d=!1,l.opts.staticGrid)return;l.grid.nodes.forEach(function(t){t.noMove||l.opts.disableDrag||l.dd.draggable(t.el,"enable"),t.noResize||l.opts.disableResize||l.dd.resizable(t.el,"enable"),t.el.trigger("resize")})}},t(window).resize(this.onResizeHandler),this.onResizeHandler(),!l.opts.staticGrid&&"string"==typeof l.opts.removable){var u=t(l.opts.removable);this.dd.isDroppable(u)||this.dd.droppable(u,l.opts.removableOptions),this.dd.on(u,"dropover",function(e,i){var o=t(i.draggable);o.data("_gridstack_node")._grid===l&&(o.data("inTrashZone",!0),l._setupRemovingTimeout(o))}).on(u,"dropout",function(e,i){var o=t(i.draggable);o.data("_gridstack_node")._grid===l&&(o.data("inTrashZone",!1),l._clearRemovingTimeout(o))})}if(!l.opts.staticGrid&&l.opts.acceptWidgets){function _(t,e){var i=m,o=i.data("_gridstack_node"),a=l.getCellFromPixel({left:t.pageX,top:t.pageY},!0),r=Math.max(0,a.x),s=Math.max(0,a.y);o._added||(o._added=!0,o.el=i,o.autoPosition=!0,o.x=r,o.y=s,l.grid.cleanNodes(),l.grid.beginUpdate(o),l.grid.addNode(o),l.container.append(l.placeholder),l.placeholder.attr("data-gs-x",o.x).attr("data-gs-y",o.y).attr("data-gs-width",o.width).attr("data-gs-height",o.height).show(),o.el=l.placeholder,o._beforeDragX=o.x,o._beforeDragY=o.y,l._updateContainerHeight()),l.grid.canMoveNode(o,r,s)&&(l.grid.moveNode(o,r,s),l._updateContainerHeight())}var m=null;this.dd.droppable(l.container,{accept:function(e){var i=(e=t(e)).data("_gridstack_node");return(!i||i._grid!==l)&&e.is(!0===l.opts.acceptWidgets?".grid-stack-item":l.opts.acceptWidgets)}}).on(l.container,"dropover",function(e,i){l.container.offset();var o=t(i.draggable),a=l.cellWidth(),r=l.cellHeight(),s=o.data("_gridstack_node"),n=l.opts.verticalMargin,d=s?s.width:Math.ceil(o.outerWidth()/a),h=s?s.height:Math.round((o.outerHeight()+n)/(r+n));m=o;var p=l.grid._prepareNode({width:d,height:h,_added:!1,_temporary:!0});p.isOutOfGrid=!0,o.data("_gridstack_node",p),o.data("_gridstack_node_orig",s),o.on("drag",_)}).on(l.container,"dropout",function(e,i){var o=t(i.draggable);if(o.data("_gridstack_node")){var a=o.data("_gridstack_node");a.isOutOfGrid&&(o.unbind("drag",_),a.el=null,l.grid.removeNode(a),l.placeholder.detach(),l._updateContainerHeight(),o.data("_gridstack_node",o.data("_gridstack_node_orig")))}}).on(l.container,"drop",function(e,i){l.placeholder.detach();var o=t(i.draggable).data("_gridstack_node");o.isOutOfGrid=!1,o._grid=l;var a=t(i.draggable).clone(!1);a.data("_gridstack_node",o);var s=t(i.draggable).data("_gridstack_node_orig");void 0!==s&&void 0!==s._grid&&s._grid._triggerRemoveEvent(),t(i.helper).remove(),o.el=a,l.placeholder.hide(),r.removePositioningStyles(a),a.find("div.ui-resizable-handle").remove(),a.attr("data-gs-x",o.x).attr("data-gs-y",o.y).attr("data-gs-width",o.width).attr("data-gs-height",o.height).addClass(l.opts.itemClass).enableSelection().removeData("draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled").unbind("drag",_),l.container.append(a),l._prepareElementsByNode(a,o),l._updateContainerHeight(),l.grid._addedNodes.push(o),l._triggerAddEvent(),l._triggerChangeEvent(),l.grid.endUpdate(),t(i.draggable).unbind("drag",_),t(i.draggable).removeData("_gridstack_node"),t(i.draggable).removeData("_gridstack_node_orig"),l.container.trigger("dropped",[s,o])})}}return n.prototype.batchUpdate=function(){this._updateCounter=1,this.float=!0},n.prototype.commit=function(){0!==this._updateCounter&&(this._updateCounter=0,this.float=this._float,this._packNodes(),this._notify())},n.prototype.getNodeDataByDOMEl=function(t){return this.nodes.find(function(e){return t.get(0)===e.el.get(0)})},n.prototype._fixCollisions=function(t){this._sortNodes(-1);var e=t,i=Boolean(this.nodes.find(function(t){return t.locked}));for(this.float||i||(e={x:0,y:t.y,width:this.column,height:t.height});;){var o=this.nodes.find(r._collisionNodeCheck,{node:t,nn:e});if(!o)return;this.moveNode(o,o.x,t.y+t.height,o.width,o.height,!0)}},n.prototype.isAreaEmpty=function(t,e,i,o){var a={x:t||0,y:e||0,width:i||1,height:o||1};return!this.nodes.find(function(t){return r.isIntercepted(t,a)})},n.prototype._sortNodes=function(t){this.nodes=r.sort(this.nodes,t,this.column)},n.prototype._packNodes=function(){this._sortNodes(),this.float?this.nodes.forEach(function(t,e){if(!t._updating&&void 0!==t._origY&&t.y!==t._origY)for(var i=t.y;i>=t._origY;)this.nodes.slice(0,e).find(r._didCollide,{n:t,newY:i})||(t._dirty=!0,t.y=i),--i},this):this.nodes.forEach(function(t,e){if(!t.locked)for(;0<t.y;){var i=t.y-1,o=0===e;if(0<e&&(o=void 0===this.nodes.slice(0,e).find(r._didCollide,{n:t,newY:i})),!o)break;t._dirty=t.y!==i,t.y=i}},this)},n.prototype._prepareNode=function(t,e){void 0!==(t=t||{}).x&&void 0!==t.y&&null!==t.x&&null!==t.y||(t.autoPosition=!0);var i={width:1,height:1,x:0,y:0};return(t=r.defaults(t,i)).x=parseInt(t.x),t.y=parseInt(t.y),t.width=parseInt(t.width),t.height=parseInt(t.height),t.autoPosition=t.autoPosition||!1,t.noResize=t.noResize||!1,t.noMove=t.noMove||!1,Number.isNaN(t.x)&&(t.x=i.x,t.autoPosition=!0),Number.isNaN(t.y)&&(t.y=i.y,t.autoPosition=!0),Number.isNaN(t.width)&&(t.width=i.width),Number.isNaN(t.height)&&(t.height=i.height),t.width>this.column?t.width=this.column:t.width<1&&(t.width=1),t.height<1&&(t.height=1),t.x<0&&(t.x=0),t.x+t.width>this.column&&(e?t.width=this.column-t.x:t.x=this.column-t.width),t.y<0&&(t.y=0),t},n.prototype._notify=function(){var t=Array.prototype.slice.call(arguments,0);if(t[0]=void 0===t[0]?[]:[t[0]],t[1]=void 0===t[1]||t[1],!this._updateCounter){var e=t[0].concat(this.getDirtyNodes());this.onchange(e,t[1])}},n.prototype.cleanNodes=function(){this._updateCounter||this.nodes.forEach(function(t){t._dirty=!1})},n.prototype.getDirtyNodes=function(){return this.nodes.filter(function(t){return t._dirty})},n.prototype.addNode=function(t,e){if(void 0!==(t=this._prepareNode(t)).maxWidth&&(t.width=Math.min(t.width,t.maxWidth)),void 0!==t.maxHeight&&(t.height=Math.min(t.height,t.maxHeight)),void 0!==t.minWidth&&(t.width=Math.max(t.width,t.minWidth)),void 0!==t.minHeight&&(t.height=Math.max(t.height,t.minHeight)),t._id=++d,t._dirty=!0,t.autoPosition){this._sortNodes();for(var i=0;;++i){var o=i%this.column,a=Math.floor(i/this.column);if(!(o+t.width>this.column||this.nodes.find(r._isAddNodeIntercepted,{x:o,y:a,node:t}))){t.x=o,t.y=a;break}}}return this.nodes.push(t),e&&this._addedNodes.push(r.clone(t)),this._fixCollisions(t),this._packNodes(),this._notify(),t},n.prototype.removeNode=function(t,e){e=void 0===e||e,this._removedNodes.push(r.clone(t)),t._id=null,this.nodes=r.without(this.nodes,t),this._packNodes(),this._notify(t,e)},n.prototype.canMoveNode=function(e,i,o,a,r){if(!this.isNodeChangedPosition(e,i,o,a,r))return!1;var s,d=Boolean(this.nodes.find(function(t){return t.locked}));if(!this.maxRow&&!d)return!0;var h=new n(this.column,null,this.float,0,this.nodes.map(function(i){return i===e?s=t.extend({},i):t.extend({},i)}));if(!s)return!0;h.moveNode(s,i,o,a,r);var l=!0;return d&&(l&=!Boolean(h.nodes.find(function(t){return t!==s&&Boolean(t.locked)&&Boolean(t._dirty)}))),this.maxRow&&(l&=h.getGridHeight()<=this.maxRow),l},n.prototype.canBePlacedWithRespectToHeight=function(e){if(!this.maxRow)return!0;var i=new n(this.column,null,this.float,0,this.nodes.map(function(e){return t.extend({},e)}));return i.addNode(e),i.getGridHeight()<=this.maxRow},n.prototype.isNodeChangedPosition=function(t,e,i,o,a){return"number"!=typeof e&&(e=t.x),"number"!=typeof i&&(i=t.y),"number"!=typeof o&&(o=t.width),"number"!=typeof a&&(a=t.height),void 0!==t.maxWidth&&(o=Math.min(o,t.maxWidth)),void 0!==t.maxHeight&&(a=Math.min(a,t.maxHeight)),void 0!==t.minWidth&&(o=Math.max(o,t.minWidth)),void 0!==t.minHeight&&(a=Math.max(a,t.minHeight)),t.x!==e||t.y!==i||t.width!==o||t.height!==a},n.prototype.moveNode=function(t,e,i,o,a,r){if(!this.isNodeChangedPosition(t,e,i,o,a))return t;if("number"!=typeof e&&(e=t.x),"number"!=typeof i&&(i=t.y),"number"!=typeof o&&(o=t.width),"number"!=typeof a&&(a=t.height),void 0!==t.maxWidth&&(o=Math.min(o,t.maxWidth)),void 0!==t.maxHeight&&(a=Math.min(a,t.maxHeight)),void 0!==t.minWidth&&(o=Math.max(o,t.minWidth)),void 0!==t.minHeight&&(a=Math.max(a,t.minHeight)),t.x===e&&t.y===i&&t.width===o&&t.height===a)return t;var s=t.width!==o;return t._dirty=!0,t.x=e,t.y=i,t.width=o,t.height=a,t.lastTriedX=e,t.lastTriedY=i,t.lastTriedWidth=o,t.lastTriedHeight=a,t=this._prepareNode(t,s),this._fixCollisions(t),r||(this._packNodes(),this._notify()),t},n.prototype.getGridHeight=function(){return this.nodes.reduce(function(t,e){return Math.max(t,e.y+e.height)},0)},n.prototype.beginUpdate=function(t){this.nodes.forEach(function(t){t._origY=t.y}),t._updating=!0},n.prototype.endUpdate=function(){this.nodes.forEach(function(t){t._origY=t.y});var t=this.nodes.find(function(t){return t._updating});t&&(t._updating=!1)},h.prototype._triggerChangeEvent=function(t){var e=this.grid.getDirtyNodes(),i=!1,o=[];e&&e.length&&(o.push(e),i=!0),!i&&!0!==t||this.container.trigger("change",o)},h.prototype._triggerAddEvent=function(){this.grid._addedNodes&&0<this.grid._addedNodes.length&&(this.container.trigger("added",[this.grid._addedNodes.map(r.clone)]),this.grid._addedNodes=[])},h.prototype._triggerRemoveEvent=function(){this.grid._removedNodes&&0<this.grid._removedNodes.length&&(this.container.trigger("removed",[this.grid._removedNodes.map(r.clone)]),this.grid._removedNodes=[])},h.prototype._initStyles=function(){this._stylesId&&r.removeStylesheet(this._stylesId),this._stylesId="gridstack-style-"+(1e5*Math.random()).toFixed(),this._styles=r.createStylesheet(this._stylesId),null!==this._styles&&(this._styles._max=0)},h.prototype._updateStyles=function(t){if(null!==this._styles&&void 0!==this._styles){var e,i="."+this.opts._class+" ."+this.opts.itemClass,o=this;if(void 0===t&&(t=this._styles._max),!(0!==this._styles._max&&t<=this._styles._max)&&(this._initStyles(),this._updateContainerHeight(),this.opts.cellHeight&&(e=this.opts.verticalMargin&&this.opts.cellHeightUnit!==this.opts.verticalMarginUnit?function(t,e){return t&&e?"calc("+(o.opts.cellHeight*t+o.opts.cellHeightUnit)+" + "+(o.opts.verticalMargin*e+o.opts.verticalMarginUnit)+")":o.opts.cellHeight*t+o.opts.verticalMargin*e+o.opts.cellHeightUnit}:function(t,e){return o.opts.cellHeight*t+o.opts.verticalMargin*e+o.opts.cellHeightUnit},0===this._styles._max&&r.insertCSSRule(this._styles,i,"min-height: "+e(1,0)+";",0),t>this._styles._max))){for(var a=this._styles._max;a<t;++a)r.insertCSSRule(this._styles,i+'[data-gs-height="'+(a+1)+'"]',"height: "+e(a+1,a)+";",a),r.insertCSSRule(this._styles,i+'[data-gs-min-height="'+(a+1)+'"]',"min-height: "+e(a+1,a)+";",a),r.insertCSSRule(this._styles,i+'[data-gs-max-height="'+(a+1)+'"]',"max-height: "+e(a+1,a)+";",a),r.insertCSSRule(this._styles,i+'[data-gs-y="'+a+'"]',"top: "+e(a,a)+";",a);this._styles._max=t}}},h.prototype._updateContainerHeight=function(){if(!this.grid._updateCounter){var t=this.grid.getGridHeight(),e=parseInt(this.container.css("min-height"));if(0<e){var i=this.opts.verticalMargin,o=Math.round((e+i)/(this.cellHeight()+i));t<o&&(t=o)}this.container.attr("data-gs-current-height",t),this.opts.cellHeight&&(this.opts.verticalMargin?this.opts.cellHeightUnit===this.opts.verticalMarginUnit?this.container.css("height",t*(this.opts.cellHeight+this.opts.verticalMargin)-this.opts.verticalMargin+this.opts.cellHeightUnit):this.container.css("height","calc("+(t*this.opts.cellHeight+this.opts.cellHeightUnit)+" + "+(t*(this.opts.verticalMargin-1)+this.opts.verticalMarginUnit)+")"):this.container.css("height",t*this.opts.cellHeight+this.opts.cellHeightUnit))}},h.prototype._isOneColumnMode=function(){return(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=this.opts.minWidth},h.prototype._setupRemovingTimeout=function(e){var i=t(e).data("_gridstack_node");!i._removeTimeout&&this.opts.removable&&(i._removeTimeout=setTimeout(function(){e.addClass("grid-stack-item-removing"),i._isAboutToRemove=!0},this.opts.removeTimeout))},h.prototype._clearRemovingTimeout=function(e){var i=t(e).data("_gridstack_node");i._removeTimeout&&(clearTimeout(i._removeTimeout),i._removeTimeout=null,e.removeClass("grid-stack-item-removing"),i._isAboutToRemove=!1)},h.prototype._prepareElementsByNode=function(e,i){function o(o,a){var s,l,p=Math.round(a.position.left/n),g=Math.floor((a.position.top+d/2)/d);if("drag"!==o.type&&(s=Math.round(a.size.width/n),l=Math.round(a.size.height/d)),"drag"===o.type){var c=a.position.top-i._prevYPix;if(i._prevYPix=a.position.top,r.updateScrollPosition(e[0],a,c),e.data("inTrashZone")||p<0||p>=h.grid.column||g<0||!h.grid.float&&g>h.grid.getGridHeight()){if(i._temporaryRemoved)return;!0===h.opts.removable&&h._setupRemovingTimeout(e),p=i._beforeDragX,g=i._beforeDragY,h.placeholder.detach(),h.placeholder.hide(),h.grid.removeNode(i),h._updateContainerHeight(),i._temporaryRemoved=!0}else h._clearRemovingTimeout(e),i._temporaryRemoved&&(h.grid.addNode(i),h.placeholder.attr("data-gs-x",p).attr("data-gs-y",g).attr("data-gs-width",s).attr("data-gs-height",l).show(),h.container.append(h.placeholder),i.el=h.placeholder,i._temporaryRemoved=!1)}else if("resize"===o.type&&p<0)return;var u=void 0!==s?s:i.lastTriedWidth,_=void 0!==l?l:i.lastTriedHeight;!h.grid.canMoveNode(i,p,g,s,l)||i.lastTriedX===p&&i.lastTriedY===g&&i.lastTriedWidth===u&&i.lastTriedHeight===_||(i.lastTriedX=p,i.lastTriedY=g,i.lastTriedWidth=s,i.lastTriedHeight=l,h.grid.moveNode(i,p,g,s,l),h._updateContainerHeight(),"resize"===o.type&&t(o.target).trigger("gsresize",i))}function a(o,a){h.container.append(h.placeholder);var r=t(this);h.grid.cleanNodes(),h.grid.beginUpdate(i),n=h.cellWidth();var s=h.cellHeight();d=h.container.height()/parseInt(h.container.attr("data-gs-current-height")),h.placeholder.attr("data-gs-x",r.attr("data-gs-x")).attr("data-gs-y",r.attr("data-gs-y")).attr("data-gs-width",r.attr("data-gs-width")).attr("data-gs-height",r.attr("data-gs-height")).show(),i.el=h.placeholder,i._beforeDragX=i.x,i._beforeDragY=i.y,i._prevYPix=a.position.top;var l=i.minHeight||1,p=h.opts.verticalMargin;h.dd.resizable(e,"option","minWidth",n*(i.minWidth||1)),h.dd.resizable(e,"option","minHeight",s*l+(l-1)*p),"resizestart"===o.type&&r.find(".grid-stack-item").trigger("resizestart")}function s(o,a){var s=t(this);if(s.data("_gridstack_node")){var n=!1;h.placeholder.detach(),i.el=s,h.placeholder.hide(),i._isAboutToRemove?(n=!0,e.data("_gridstack_node")._grid._triggerRemoveEvent(),e.removeData("_gridstack_node"),e.remove()):(h._clearRemovingTimeout(e),i._temporaryRemoved?(r.removePositioningStyles(s),s.attr("data-gs-x",i._beforeDragX).attr("data-gs-y",i._beforeDragY).attr("data-gs-width",i.width).attr("data-gs-height",i.height),i.x=i._beforeDragX,i.y=i._beforeDragY,i._temporaryRemoved=!1,h.grid.addNode(i)):(r.removePositioningStyles(s),s.attr("data-gs-x",i.x).attr("data-gs-y",i.y).attr("data-gs-width",i.width).attr("data-gs-height",i.height))),h._updateContainerHeight(),h._triggerChangeEvent(n),h.grid.endUpdate();var d=s.find(".grid-stack");d.length&&"resizestop"===o.type&&(d.each(function(e,i){t(i).data("gridstack").onResizeHandler()}),s.find(".grid-stack-item").trigger("resizestop"),s.find(".grid-stack-item").trigger("gsresizestop")),"resizestop"===o.type&&h.container.trigger("gsresizestop",s)}}var n,d,h=this;this.dd.draggable(e,{start:a,stop:s,drag:o}).resizable(e,{start:a,stop:s,resize:o}),(i.noMove||this._isOneColumnMode()&&!h.opts.disableOneColumnMode||this.opts.disableDrag||this.opts.staticGrid)&&this.dd.draggable(e,"disable"),(i.noResize||this._isOneColumnMode()&&!h.opts.disableOneColumnMode||this.opts.disableResize||this.opts.staticGrid)&&this.dd.resizable(e,"disable"),e.attr("data-gs-locked",i.locked?"yes":null)},h.prototype._prepareElement=function(e,i){i=void 0!==i&&i,(e=t(e)).addClass(this.opts.itemClass);var o=this.grid.addNode({x:e.attr("data-gs-x"),y:e.attr("data-gs-y"),width:e.attr("data-gs-width"),height:e.attr("data-gs-height"),maxWidth:e.attr("data-gs-max-width"),minWidth:e.attr("data-gs-min-width"),maxHeight:e.attr("data-gs-max-height"),minHeight:e.attr("data-gs-min-height"),autoPosition:r.toBool(e.attr("data-gs-auto-position")),noResize:r.toBool(e.attr("data-gs-no-resize")),noMove:r.toBool(e.attr("data-gs-no-move")),locked:r.toBool(e.attr("data-gs-locked")),resizeHandles:e.attr("data-gs-resize-handles"),el:e,id:e.attr("data-gs-id"),_grid:this},i);e.data("_gridstack_node",o),this._prepareElementsByNode(e,o)},h.prototype.setAnimation=function(t){t?this.container.addClass("grid-stack-animate"):this.container.removeClass("grid-stack-animate")},h.prototype.addWidget=function(e,i,o,a,r,s,n,d,h,l,p){return null!==i&&"object"==typeof i?this.addWidget(e,i.x,i.y,i.width,i.height,i.autoPosition,i.minWidth,i.maxWidth,i.minHeight,i.maxHeight,i.id):(e=t(e),void 0!==i&&e.attr("data-gs-x",i),void 0!==o&&e.attr("data-gs-y",o),void 0!==a&&e.attr("data-gs-width",a),void 0!==r&&e.attr("data-gs-height",r),void 0!==s&&e.attr("data-gs-auto-position",s?"yes":null),void 0!==n&&e.attr("data-gs-min-width",n),void 0!==d&&e.attr("data-gs-max-width",d),void 0!==h&&e.attr("data-gs-min-height",h),void 0!==l&&e.attr("data-gs-max-height",l),void 0!==p&&e.attr("data-gs-id",p),this.container.append(e),this._prepareElement(e,!0),this._triggerAddEvent(),this._updateContainerHeight(),this._triggerChangeEvent(!0),e)},h.prototype.makeWidget=function(e){return e=t(e),this._prepareElement(e,!0),this._triggerAddEvent(),this._updateContainerHeight(),this._triggerChangeEvent(!0),e},h.prototype.willItFit=function(t,e,i,o,a){var r={x:t,y:e,width:i,height:o,autoPosition:a};return this.grid.canBePlacedWithRespectToHeight(r)},h.prototype.removeWidget=function(e,i){i=void 0===i||i;var o=(e=t(e)).data("_gridstack_node");o=o||this.grid.getNodeDataByDOMEl(e),this.grid.removeNode(o,i),e.removeData("_gridstack_node"),this._updateContainerHeight(),i&&e.remove(),this._triggerChangeEvent(!0),this._triggerRemoveEvent()},h.prototype.removeAll=function(t){this.grid.nodes.forEach(function(e){this.removeWidget(e.el,t)},this),this.grid.nodes=[],this._updateContainerHeight()},h.prototype.destroy=function(e){t(window).off("resize",this.onResizeHandler),this.disable(),void 0===e||e?this.container.remove():(this.removeAll(!1),this.container.removeData("gridstack")),r.removeStylesheet(this._stylesId),this.grid&&(this.grid=null)},h.prototype.resizable=function(e,i){var o=this;return(e=t(e)).each(function(e,a){var r=(a=t(a)).data("_gridstack_node");r&&(r.noResize=!i,r.noResize||o._isOneColumnMode()&&!o.opts.disableOneColumnMode?o.dd.resizable(a,"disable"):o.dd.resizable(a,"enable"))}),this},h.prototype.movable=function(e,i){var o=this;return(e=t(e)).each(function(e,a){var r=(a=t(a)).data("_gridstack_node");r&&(r.noMove=!i,r.noMove||o._isOneColumnMode()&&!o.opts.disableOneColumnMode?(o.dd.draggable(a,"disable"),a.removeClass("ui-draggable-handle")):(o.dd.draggable(a,"enable"),a.addClass("ui-draggable-handle")))}),this},h.prototype.enableMove=function(t,e){this.movable(this.container.children("."+this.opts.itemClass),t),e&&(this.opts.disableDrag=!t)},h.prototype.enableResize=function(t,e){this.resizable(this.container.children("."+this.opts.itemClass),t),e&&(this.opts.disableResize=!t)},h.prototype.disable=function(){this.movable(this.container.children("."+this.opts.itemClass),!1),this.resizable(this.container.children("."+this.opts.itemClass),!1),this.container.trigger("disable")},h.prototype.enable=function(){this.movable(this.container.children("."+this.opts.itemClass),!0),this.resizable(this.container.children("."+this.opts.itemClass),!0),this.container.trigger("enable")},h.prototype.locked=function(e,i){return(e=t(e)).each(function(e,o){var a=(o=t(o)).data("_gridstack_node");a&&(a.locked=i||!1,o.attr("data-gs-locked",a.locked?"yes":null))}),this},h.prototype.maxHeight=function(e,i){return(e=t(e)).each(function(e,o){var a=(o=t(o)).data("_gridstack_node");a&&(isNaN(i)||(a.maxHeight=i||!1,o.attr("data-gs-max-height",i)))}),this},h.prototype.minHeight=function(e,i){return(e=t(e)).each(function(e,o){var a=(o=t(o)).data("_gridstack_node");a&&(isNaN(i)||(a.minHeight=i||!1,o.attr("data-gs-min-height",i)))}),this},h.prototype.maxWidth=function(e,i){return(e=t(e)).each(function(e,o){var a=(o=t(o)).data("_gridstack_node");a&&(isNaN(i)||(a.maxWidth=i||!1,o.attr("data-gs-max-width",i)))}),this},h.prototype.minWidth=function(e,i){return(e=t(e)).each(function(e,o){var a=(o=t(o)).data("_gridstack_node");a&&(isNaN(i)||(a.minWidth=i||!1,o.attr("data-gs-min-width",i)))}),this},h.prototype._updateElement=function(e,i){var o=(e=t(e).first()).data("_gridstack_node");if(o){var a=this;a.grid.cleanNodes(),a.grid.beginUpdate(o),i.call(this,e,o),a._updateContainerHeight(),a._triggerChangeEvent(),a.grid.endUpdate()}},h.prototype.resize=function(t,e,i){this._updateElement(t,function(t,o){e=null!=e?e:o.width,i=null!=i?i:o.height,this.grid.moveNode(o,o.x,o.y,e,i)})},h.prototype.move=function(t,e,i){this._updateElement(t,function(t,o){e=null!=e?e:o.x,i=null!=i?i:o.y,this.grid.moveNode(o,e,i,o.width,o.height)})},h.prototype.update=function(t,e,i,o,a){this._updateElement(t,function(t,r){e=null!=e?e:r.x,i=null!=i?i:r.y,o=null!=o?o:r.width,a=null!=a?a:r.height,this.grid.moveNode(r,e,i,o,a)})},h.prototype.verticalMargin=function(t,e){if(void 0===t)return this.opts.verticalMargin;var i=r.parseHeight(t);this.opts.verticalMarginUnit===i.unit&&this.opts.maxRow===i.height||(this.opts.verticalMarginUnit=i.unit,this.opts.verticalMargin=i.height,e||this._updateStyles())},h.prototype.cellHeight=function(t,e){if(void 0===t){if(this.opts.cellHeight&&"auto"!==this.opts.cellHeight)return this.opts.cellHeight;var i=this.container.children("."+this.opts.itemClass).first(),o=i.attr("data-gs-height"),a=this.opts.verticalMargin;return Math.round((i.outerHeight()-(o-1)*a)/o)}var s=r.parseHeight(t);this.opts.cellHeightUnit===s.unit&&this.opts.cellHeight===s.height||(this.opts.cellHeightUnit=s.unit,this.opts.cellHeight=s.height,e||this._updateStyles())},h.prototype.cellWidth=function(){return Math.round(this.container.outerWidth()/this.opts.column)},h.prototype.getCellFromPixel=function(t,e){var i=void 0!==e&&e?this.container.offset():this.container.position(),o=t.left-i.left,a=t.top-i.top,r=Math.floor(this.container.width()/this.opts.column),s=Math.floor(this.container.height()/parseInt(this.container.attr("data-gs-current-height")));return{x:Math.floor(o/r),y:Math.floor(a/s)}},h.prototype.batchUpdate=function(){this.grid.batchUpdate()},h.prototype.commit=function(){this.grid.commit(),this._updateContainerHeight()},h.prototype.isAreaEmpty=function(t,e,i,o){return this.grid.isAreaEmpty(t,e,i,o)},h.prototype.setStatic=function(t){this.opts.staticGrid=!0===t,this.enableMove(!t),this.enableResize(!t),this._setStaticClass()},h.prototype._setStaticClass=function(){var t="grid-stack-static";!0===this.opts.staticGrid?this.container.addClass(t):this.container.removeClass(t)},h.prototype._updateNodeWidths=function(t,e){this.grid._sortNodes(),this.grid.batchUpdate();for(var i={},o=0;o<this.grid.nodes.length;o++)i=this.grid.nodes[o],this.update(i.el,Math.round(i.x*e/t),void 0,Math.round(i.width*e/t),void 0);this.grid.commit()},h.prototype.setColumn=function(t,e){this.opts.column!==t&&(this.container.removeClass("grid-stack-"+this.opts.column),!0!==e&&this._updateNodeWidths(this.opts.column,t),this.opts.column=this.grid.column=t,this.container.addClass("grid-stack-"+t))},h.prototype.setGridWidth=function(t,e){console.warn("gridstack.js: setGridWidth() is deprecated as of v0.5.3 and has been replaced with setColumn(). It will be **completely** removed in v1.0."),this.setColumn(t,e)},n.prototype.batch_update=i(n.prototype.batchUpdate),n.prototype._fix_collisions=i(n.prototype._fixCollisions,"_fix_collisions","_fixCollisions"),n.prototype.is_area_empty=i(n.prototype.isAreaEmpty,"is_area_empty","isAreaEmpty"),n.prototype._sort_nodes=i(n.prototype._sortNodes,"_sort_nodes","_sortNodes"),n.prototype._pack_nodes=i(n.prototype._packNodes,"_pack_nodes","_packNodes"),n.prototype._prepare_node=i(n.prototype._prepareNode,"_prepare_node","_prepareNode"),n.prototype.clean_nodes=i(n.prototype.cleanNodes,"clean_nodes","cleanNodes"),n.prototype.get_dirty_nodes=i(n.prototype.getDirtyNodes,"get_dirty_nodes","getDirtyNodes"),n.prototype.add_node=i(n.prototype.addNode,"add_node","addNode, "),n.prototype.remove_node=i(n.prototype.removeNode,"remove_node","removeNode"),n.prototype.can_move_node=i(n.prototype.canMoveNode,"can_move_node","canMoveNode"),n.prototype.move_node=i(n.prototype.moveNode,"move_node","moveNode"),n.prototype.get_grid_height=i(n.prototype.getGridHeight,"get_grid_height","getGridHeight"),n.prototype.begin_update=i(n.prototype.beginUpdate,"begin_update","beginUpdate"),n.prototype.end_update=i(n.prototype.endUpdate,"end_update","endUpdate"),n.prototype.can_be_placed_with_respect_to_height=i(n.prototype.canBePlacedWithRespectToHeight,"can_be_placed_with_respect_to_height","canBePlacedWithRespectToHeight"),h.prototype._trigger_change_event=i(h.prototype._triggerChangeEvent,"_trigger_change_event","_triggerChangeEvent"),h.prototype._init_styles=i(h.prototype._initStyles,"_init_styles","_initStyles"),h.prototype._update_styles=i(h.prototype._updateStyles,"_update_styles","_updateStyles"),h.prototype._update_container_height=i(h.prototype._updateContainerHeight,"_update_container_height","_updateContainerHeight"),h.prototype._is_one_column_mode=i(h.prototype._isOneColumnMode,"_is_one_column_mode","_isOneColumnMode"),h.prototype._prepare_element=i(h.prototype._prepareElement,"_prepare_element","_prepareElement"),h.prototype.set_animation=i(h.prototype.setAnimation,"set_animation","setAnimation"),h.prototype.add_widget=i(h.prototype.addWidget,"add_widget","addWidget"),h.prototype.make_widget=i(h.prototype.makeWidget,"make_widget","makeWidget"),h.prototype.will_it_fit=i(h.prototype.willItFit,"will_it_fit","willItFit"),h.prototype.remove_widget=i(h.prototype.removeWidget,"remove_widget","removeWidget"),h.prototype.remove_all=i(h.prototype.removeAll,"remove_all","removeAll"),h.prototype.min_height=i(h.prototype.minHeight,"min_height","minHeight"),h.prototype.min_width=i(h.prototype.minWidth,"min_width","minWidth"),h.prototype._update_element=i(h.prototype._updateElement,"_update_element","_updateElement"),h.prototype.cell_height=i(h.prototype.cellHeight,"cell_height","cellHeight"),h.prototype.cell_width=i(h.prototype.cellWidth,"cell_width","cellWidth"),h.prototype.get_cell_from_pixel=i(h.prototype.getCellFromPixel,"get_cell_from_pixel","getCellFromPixel"),h.prototype.batch_update=i(h.prototype.batchUpdate,"batch_update","batchUpdate"),h.prototype.is_area_empty=i(h.prototype.isAreaEmpty,"is_area_empty","isAreaEmpty"),h.prototype.set_static=i(h.prototype.setStatic,"set_static","setStatic"),h.prototype._set_static_class=i(h.prototype._setStaticClass,"_set_static_class","_setStaticClass"),e.GridStackUI=h,e.GridStackUI.Utils=r,e.GridStackUI.Engine=n,e.GridStackUI.GridStackDragDropPlugin=s,t.fn.gridstack=function(e){return this.each(function(){var i=t(this);i.data("gridstack")||i.data("gridstack",new h(this,e))})},e.GridStackUI}),function(t){if("function"==typeof define&&define.amd)define(["jquery","gridstack","exports","jquery-ui/data","jquery-ui/disable-selection","jquery-ui/focusable","jquery-ui/form","jquery-ui/ie","jquery-ui/keycode","jquery-ui/labels","jquery-ui/jquery-1-7","jquery-ui/plugin","jquery-ui/safe-active-element","jquery-ui/safe-blur","jquery-ui/scroll-parent","jquery-ui/tabbable","jquery-ui/unique-id","jquery-ui/version","jquery-ui/widget","jquery-ui/widgets/mouse","jquery-ui/widgets/draggable","jquery-ui/widgets/droppable","jquery-ui/widgets/resizable"],t);else if("undefined"!=typeof exports){try{jQuery=require("jquery")}catch(t){}try{gridstack=require("gridstack")}catch(t){}t(jQuery,gridstack.GridStackUI,exports)}else t(jQuery,GridStackUI,window)}(function(t,e,i){function o(t){e.GridStackDragDropPlugin.call(this,t)}return e.GridStackDragDropPlugin.registerPlugin(o),((o.prototype=Object.create(e.GridStackDragDropPlugin.prototype)).constructor=o).prototype.resizable=function(e,i){if(e=t(e),"disable"===i||"enable"===i)e.resizable(i);else if("option"===i){var o=arguments[2],a=arguments[3];e.resizable(i,o,a)}else{var r=e.data("gs-resize-handles")?e.data("gs-resize-handles"):this.grid.opts.resizable.handles;e.resizable(t.extend({},this.grid.opts.resizable,{handles:r},{start:i.start||function(){},stop:i.stop||function(){},resize:i.resize||function(){}}))}return this},o.prototype.draggable=function(e,i){return e=t(e),"disable"===i||"enable"===i?e.draggable(i):e.draggable(t.extend({},this.grid.opts.draggable,{containment:this.grid.opts.isNested?this.grid.container.parent():null,start:i.start||function(){},stop:i.stop||function(){},drag:i.drag||function(){}})),this},o.prototype.droppable=function(e,i){return(e=t(e)).droppable(i),this},o.prototype.isDroppable=function(e,i){return e=t(e),Boolean(e.data("droppable"))},o.prototype.on=function(e,i,o){return t(e).on(i,o),this},i.JQueryUIGridStackDragDropPlugin=o});