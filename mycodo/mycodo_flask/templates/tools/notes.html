{% extends "layout.html" %}
{% set active_page = "notes" %}
{% set help_page = ["notes", _('Notes')] %}

{% block title %} - {{_('Notes')}}{% endblock %}

{% block body %}
<!-- Route: /notes -->
<div class="container">
  {% include 'flash_messages.html' %}

  <h4>{{_('Notes')}} <a href="/help#{{help_page[0]}}" target="_blank"><span style="font-size: 16px" class="fas fa-question-circle"></span></a></h4>

  <div style="clear: both; padding: 1em 0;"></div>

  <h3>{{_('Note Tags')}}</h3>

  <p>Tags allow categorization of notes. A note may have more than one tag. A tag may be selected to display a set of notes on a graph.</p>

   <form class="form-horizontal" method="post" action="/notes">
   {{form_tag_add.csrf_token}}
   <div class="row align-items-end">
    <div class="col-auto">
      {{form_tag_add.tag_name.label(class_='control-label')}}
      <div>
        {{form_tag_add.tag_name(class_='form-control')}}
      </div>
    </div>
    <div class="col-auto">
      {{form_tag_add.tag_add(class_='btn btn-primary')}}
    </div>
  </div>
  </form>

  {% if tags %}

  <form class="form-horizontal" method="post" action="/notes">
 {{form_tag_options.csrf_token}}
  <div class="row align-items-end">
    <div class="col-auto">
      {{form_tag_options.tag_unique_id.label(class_='control-label')}}
      <div>
        <select class="form-control" id="tag_unique_id" name="tag_unique_id" title="" data-original-title="Select the tag to delete">
          {%- for each_tag in tags -%}
            <option value="{{each_tag.unique_id}}">{{each_tag.name}}</option>
          {%- endfor -%}
        </select>
      </div>
    </div>
    <div class="col-auto">
      {{form_tag_options.tag_del(class_='btn btn-primary')}}
    </div>
  </div>
  </form>

  {% endif %}

  <div style="clear: both; padding: 1em 0;"></div>

  <h3>{{_('Notes')}}</h3>

  <p>Enter one or more tag separated by a comma (",").</p>

  <form method="post" action="/notes" enctype=multipart/form-data>
  {{form_note_add.csrf_token}}
  <div class="row">
    <div class="col-auto">
      {{form_note_add.name.label(class_='control-label')}}
      <div>
        {{form_note_add.name(class_='form-control')}}
      </div>
    </div>
    <div class="col-auto">
      {{form_note_add.tags.label(class_='control-label')}}
      <div>
        {{form_note_add.tags(class_='form-control')}}
      </div>
    </div>
    <div class="col-auto">
      {{form_note_add.files.label(class_='control-label')}}
      <div class="fileinput fileinput-new" data-provides="fileinput">
        <span class="btn btn-default btn-file"><input id="files" name="files" type="file" /></span>
      </div>
    </div>
    <div class="col-12">
      {{form_note_add.note.label(class_='control-label')}}
      <div>
        {{form_note_add.note(class_='form-control')}}
      </div>
    </div>
    <div class="col-auto">
      {{form_note_add.enter_custom_date_time.label(class_='control-label')}}
      <div class="input-group-text">
        <input class="form-control" id="enter_custom_date_time" name="enter_custom_date_time" type="checkbox" value="y">
      </div>
    </div>
    <div class="col-auto">
      {{form_note_add.date_time.label(class_='control-label')}}
      <div>
        {{form_note_add.date_time(class_='form-control', value=current_date_time)}}
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-auto">
      <label class="control-label">&nbsp;</label>
      <div>
        {{form_note_add.note_add(class_='btn btn-primary')}}
      </div>
    </div>
  </div>
  <div class="row">

  </div>
  </form>

  {% if notes %}

  <div class="table-responsive">
    <table class="table">
      <tr>
        <td>ID</td>
        <td>Name</td>
        <td>Tags</td>
        <td>Files</td>
        <td>Note</td>
        <td></td>
      </tr>

    {% for each_note in notes %}

    <form method="post" action="/notes">
    {{form_note_options.csrf_token}}
    {{form_note_options.note_unique_id(value=each_note.unique_id)}}

      <tr>
        <td>{{each_note.id}}</td>
        <td>{{each_note.name}}</td>
        <td>{{each_note.tags}}</td>
        <td>{{each_note.files}}</td>
        <td>{{each_note.note}}</td>
        <td>
          <div class="col-12 small-gutters">
            {{form_note_options.note_del(class_='btn btn-primary btn-block', **{'onclick':'return confirm("Are you sure you want to delete this?")'})}}
          </div>
        </td>
      </tr>

    </form>

  <div style="clear: both; padding: 0.5em 0;"></div>

    {% endfor -%}

    </table>
  </div>

  {% endif %}

  <div style="clear: both; padding: 1em 0;"></div>

</div>

{% endblock %}
